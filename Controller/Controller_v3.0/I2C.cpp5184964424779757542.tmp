#include "I2C.h"

I2C::I2C(int id)
{
  this->id = id;
}

I2C::~I2C(void)
{

}

void I2C::Begin()
{
  Wire.begin(this->id);
  Wire.onReceive(receiveEvent);
}

COMMANDS I2C::readCommand(int id)
{
  return error;
}

int I2C::sendCommand(int id, String message)
{
  int rv = 0;
  Wire.beginTransmission(id);
  message = _format(message);
  Wire.write(message);
  Wire.endTransmission();
  return rv;
}

void I2C::receiveEvent(int howMany)
{
  while (Wire.available() > 0)
  {
    this->_readByte = Wire.read();
    _receivedChar = (char) _readByte;
    if (this->_receivedChar == '#')
    {
      this->_command = true;
      this->msg = "";
    }
    else if (this->_receivedChar == '@')
    {
      this->_command = false;

    }
    else if (this->_command == true)
    {
      this->msg = msg + _receivedChar;
    }
  }
}

